(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64de2ea4"],{"11e9":function(e,t,a){var n=a("52a7"),s=a("4630"),r=a("6821"),i=a("6a99"),o=a("69a8"),l=a("c69a"),c=Object.getOwnPropertyDescriptor;t.f=a("9e1e")?c:function(e,t){if(e=r(e),t=i(t,!0),l)try{return c(e,t)}catch(a){}if(o(e,t))return s(!n.f.call(e,t),e[t])}},"27fe":function(e,t,a){"use strict";var n=a("6b19"),s=a.n(n);s.a},"5dbc":function(e,t,a){var n=a("d3f4"),s=a("8b97").set;e.exports=function(e,t,a){var r,i=t.constructor;return i!==a&&"function"==typeof i&&(r=i.prototype)!==a.prototype&&n(r)&&s&&s(e,r),e}},6102:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"header-content"},[a("span",{staticStyle:{"margin-left":"30px"}},[e._v("日志监控")]),a("div",{staticStyle:{display:"inline-block","margin-left":"50px"}},[e._v("\n      实例：\n      "),a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择实例",filterable:""},on:{change:e.changInst},model:{value:e.selectInstId,callback:function(t){e.selectInstId=t},expression:"selectInstId"}},e._l(e.selectInstData,(function(e,t){return a("el-option",{key:t,attrs:{label:e.instName,value:e.pgInstId}})})),1),e._v("\n      节点：\n      "),a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择实例节点"},on:{change:e.changNode},model:{value:e.selectNode,callback:function(t){e.selectNode=t},expression:"selectNode"}},e._l(e.nodeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.pgNodeId}})})),1)],1)]),a("div",{staticClass:"instance-list-wrap"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"tab-style",attrs:{label:"慢日志",name:"first"}},[a("div",[a("span",[e._v("sql关键字：")]),a("el-input",{attrs:{placeholder:"请输入sql关键字"},model:{value:e.sqlKeyWord,callback:function(t){e.sqlKeyWord=t},expression:"sqlKeyWord"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("执行时间：")]),a("el-input",{attrs:{placeholder:"请输入时间进行筛选，单位s"},model:{value:e.executeTime,callback:function(t){e.executeTime=t},expression:"executeTime"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("自定义查询时间：")]),a("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetimerange","range-separator":"-",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始时间","end-placeholder":"结束时间"},on:{change:e.pickStatsTime},model:{value:e.resourceTime,callback:function(t){e.resourceTime=t},expression:"resourceTime"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.searchSlowSql}},[e._v("查询")])],1),a("div",{staticClass:"table-style"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.sqlSlowLoad,expression:"sqlSlowLoad"}],attrs:{data:e.sqlQueryList}},[a("el-table-column",{attrs:{label:"数据库",prop:"dbName","min-width":"60"}}),a("el-table-column",{attrs:{label:"用户",prop:"userName","min-width":"60"}}),a("el-table-column",{attrs:{label:"程序",prop:"appName"}}),a("el-table-column",{attrs:{label:"客户端地址",prop:"clientAddr"}}),a("el-table-column",{attrs:{label:"客户端端口",prop:"clientPort","min-width":"70"}}),a("el-table-column",{attrs:{label:"开始时间",prop:"queryStart","min-width":"100"}}),a("el-table-column",{attrs:{label:"结束时间",prop:"queryEnd","min-width":"100"}}),a("el-table-column",{attrs:{label:"语句","show-overflow-tooltip":!0,prop:"query","min-width":"180"}}),a("el-table-column",{attrs:{label:"耗时（毫秒）",prop:"queryCost","min-width":"80"}})],1),a("div",{staticStyle:{float:"right","margin-top":"10px","margin-bottom":"20px"}},[e.totalRecord>10?a("el-pagination",{attrs:{"page-size":e.pageSize,total:e.totalRecord,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)],1)]),a("el-tab-pane",{staticClass:"tab-style",attrs:{label:"错误日志",name:"second"}},[a("div",[a("span",[e._v("日志级别：")]),a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择日志级别"},on:{change:e.changeLevel},model:{value:e.logLevel,callback:function(t){e.logLevel=t},expression:"logLevel"}},e._l(e.logLevelList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.level,value:e.level}})})),1),a("span",[e._v("自定义查询时间：")]),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","picker-options":e.pickerOptions,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始时间","end-placeholder":"结束时间"},on:{change:e.pickStatsTime1},model:{value:e.resourceTime1,callback:function(t){e.resourceTime1=t},expression:"resourceTime1"}})],1),a("div",{staticClass:"table-style"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.logLoad,expression:"logLoad"}],attrs:{data:e.logQueryList}},[a("el-table-column",{attrs:{label:"time",prop:"time","min-width":"100px"}}),a("el-table-column",{attrs:{label:"level",prop:"level","min-width":"100px"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"message",prop:"message","min-width":"350px"}})],1),a("div",{staticStyle:{float:"right","margin-top":"10px","margin-bottom":"20px"}},[e.totalRecord1>10?a("el-pagination",{attrs:{"page-size":e.pageSize1,total:e.totalRecord1,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}}):e._e()],1)],1)])],1)],1)])},s=[],r=(a("6b54"),a("2397"),a("ac6a"),a("c5f6"),a("96cf"),a("3b8d")),i=a("d225"),o=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),d=a("9ab4"),p=a("60a3"),g=a("852f"),h=a("4bb5");function f(e){return function(){var t,a=Object(c["a"])(e);if(m()){var n=Object(c["a"])(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return Object(l["a"])(this,t)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}a("313e");var v=function(e){Object(u["a"])(a,e);var t=f(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.selectInst="",e.selectInstData=[],e.nodeList=[],e.selectNode=null,e.selectNodeData=[],e.resourceTime=[e.formatDate(new Date((new Date).getTime()-36e5)),e.formatDate(new Date)],e.resourceTime1=[e.formatDate(new Date((new Date).getTime()-36e5)),e.formatDate(new Date)],e.selectInstId="",e.activeName="first",e.totalRecord=0,e.pageSize=10,e.pageIndex=1,e.sqlKeyWord="",e.executeTime="",e.sqlQueryList=[],e.sqlSlowLoad=!1,e.pageSize1=10,e.pageIndex1=1,e.totalRecord1=0,e.logLevelList=[{level:"ALL"},{level:"ERROR"},{level:"FATAL"},{level:"PANIC"}],e.logLevel=e.logLevelList[0].level,e.logQueryList=[],e.logLoad=!1,e.pickerOptions={disabledDate:function(e){var t=Date.now()-864e6;return Date.now()<=e||!(e>=t)}},e}return Object(o["a"])(a,[{key:"mounted",value:function(){sessionStorage.getItem("selectInst")&&(this.selectInst=sessionStorage.getItem("selectInst")||""),sessionStorage.getItem("selectInstId")&&(this.selectInst=sessionStorage.getItem("selectInstId")||""),this.getInstList()}},{key:"getInstList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={tenantId:this.data.paasConfig.userInfo.currentTenantId,pageNum:1,pageSize:9999},e.next=4,g["a"].getInstList(t);case 4:a=e.sent,0==a.data.code?(this.selectInstData=a.data.data.list,sessionStorage.getItem("selectInstId")?this.selectInstId=sessionStorage.getItem("selectInstId")||"":this.selectInstId=a.data.data.list[0].pgInstId,this.getNodeList(this.selectInstId)):this.$message.warning("获取数据失败，".concat(a.data.msg)),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:return e.prev=10,e.finish(10);case 12:case"end":return e.stop()}}),e,this,[[0,8,10,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"searchSlowSql",value:function(){this.getSlowSql()}},{key:"changInst",value:function(e){sessionStorage.setItem("selectInstId",e),this.selectInstId=e,sessionStorage.removeItem("selectNode"),this.getNodeList(e)}},{key:"changNode",value:function(e){sessionStorage.setItem("selectNode",e),this.selectNode=e,this.getSlowSql(),this.getLogData()}},{key:"getNodeList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,n,s,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.nodeList=[],e.prev=1,a={tenantId:this.data.paasConfig.userInfo.currentTenantId,instId:t},e.next=5,g["a"].getNodeList(a);case 5:if(n=e.sent,0==n.data.code){for(this.selectNodeData=n.data.data,this.selectNode=this.selectNodeData[0].pgNodeId,s=0;s<this.selectNodeData.length;s++)this.selectNodeData[s].primary?this.selectNodeData[s].role="主库":this.selectNodeData[s].role="备库";sessionStorage.getItem("selectNode")?this.selectNode=Number(sessionStorage.getItem("selectNode")||""):this.selectNode=this.selectNodeData[0].pgNodeId,this.selectNodeData.forEach((function(e){r.nodeList.push({label:e.host+":"+e.servicePort+" "+e.role,pgNodeId:e.pgNodeId})})),this.getSlowSql(),this.getLogData()}else this.$message.warning("获取数据失败，".concat(n.data.msg));e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](1);case 11:return e.prev=11,e.finish(11);case 13:case"end":return e.stop()}}),e,this,[[1,9,11,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSlowSql",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.sqlSlowLoad=!0,e.prev=1,t={tenantId:this.data.paasConfig.userInfo.currentTenantId,instId:this.selectInstId,nodeId:this.selectNode,cost:this.executeTime,sql:this.sqlKeyWord,startTime:this.resourceTime[0],endTime:this.resourceTime[1],pageNum:this.pageIndex,pageSize:this.pageSize},e.next=5,g["a"].getSlowSql(t);case 5:a=e.sent,0==a.data.code?(this.sqlSlowLoad=!1,this.sqlQueryList=a.data.data.list,this.totalRecord=a.data.data.total):(this.sqlSlowLoad=!1,this.$message.error(a.data.msg)),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message.error(e.t0),this.sqlSlowLoad=!1;case 13:return e.prev=13,e.finish(13);case 15:case"end":return e.stop()}}),e,this,[[1,9,13,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getLogData",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.logLoad=!0,e.prev=1,t={tenantId:this.data.paasConfig.userInfo.currentTenantId,instId:this.selectInstId,nodeId:this.selectNode,level:this.logLevel,startTime:this.resourceTime1[0],endTime:this.resourceTime1[1],pageNum:this.pageIndex1,pageSize:this.pageSize1},e.next=5,g["a"].getLogData(t);case 5:a=e.sent,0==a.data.code?(this.logQueryList=a.data.data.list,this.totalRecord1=a.data.data.total,this.logLoad=!1):(this.logLoad=!1,this.$message.error(a.data.msg)),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message.error(e.t0),this.logLoad=!1;case 13:return e.prev=13,e.finish(13);case 15:case"end":return e.stop()}}),e,this,[[1,9,13,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeLevel",value:function(e){this.logLevel=e,this.getLogData()}},{key:"formatDate",value:function(e){var t=e.getFullYear()+"-"+this.p(e.getMonth()+1)+"-"+this.p(e.getDate()),a=this.p(e.getHours())+":"+this.p(e.getMinutes())+":"+this.p(e.getSeconds());return t+" "+a}},{key:"p",value:function(e){return e<10?"0"+e:e}},{key:"pickStatsTime",value:function(e){this.resourceTime=e,this.getSlowSql()}},{key:"pickStatsTime1",value:function(e){this.resourceTime1=e,this.getLogData()}},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.getSlowSql()}},{key:"handleCurrentChange",value:function(e){this.pageIndex=e,this.getSlowSql()}},{key:"handleSizeChange1",value:function(e){this.pageSize1=e,this.getLogData()}},{key:"handleCurrentChange1",value:function(e){this.pageIndex1=e,this.getLogData()}}]),a}(p["c"]);Object(d["a"])([Object(h["a"])("data/getData")],v.prototype,"data",void 0),v=Object(d["a"])([p["a"]],v);var b=v,I=b,y=(a("27fe"),a("2877")),S=Object(y["a"])(I,n,s,!1,null,"be2a9a5a",null);t["default"]=S.exports},"6b19":function(e,t,a){},"8b97":function(e,t,a){var n=a("d3f4"),s=a("cb7c"),r=function(e,t){if(s(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(s){t=!0}return function(e,a){return r(e,a),t?e.__proto__=a:n(e,a),e}}({},!1):void 0),check:r}},9093:function(e,t,a){var n=a("ce10"),s=a("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,s)}},aa77:function(e,t,a){var n=a("5ca1"),s=a("be13"),r=a("79e5"),i=a("fdef"),o="["+i+"]",l="​",c=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(e,t,a){var s={},o=r((function(){return!!i[e]()||l[e]()!=l})),c=s[e]=o?t(p):i[e];a&&(s[a]=c),n(n.P+n.F*o,"String",s)},p=d.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},c5f6:function(e,t,a){"use strict";var n=a("7726"),s=a("69a8"),r=a("2d95"),i=a("5dbc"),o=a("6a99"),l=a("79e5"),c=a("9093").f,u=a("11e9").f,d=a("86cc").f,p=a("aa77").trim,g="Number",h=n[g],f=h,m=h.prototype,v=r(a("2aeb")(m))==g,b="trim"in String.prototype,I=function(e){var t=o(e,!1);if("string"==typeof t&&t.length>2){t=b?t.trim():p(t,3);var a,n,s,r=t.charCodeAt(0);if(43===r||45===r){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+t}for(var i,l=t.slice(2),c=0,u=l.length;c<u;c++)if(i=l.charCodeAt(c),i<48||i>s)return NaN;return parseInt(l,n)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof h&&(v?l((function(){m.valueOf.call(a)})):r(a)!=g)?i(new f(I(t)),a,h):I(t)};for(var y,S=a("9e1e")?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;S.length>N;N++)s(f,y=S[N])&&!s(h,y)&&d(h,y,u(f,y));h.prototype=m,m.constructor=h,a("2aba")(n,g,h)}},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);